# 操作总结 - 实现自动标签提取功能

## 最后接收的提示词
如何实现当用户输入完内容后给内容打标签

## 用户输入的要求
实现当用户输入完内容后，自动提取关键信息（如人名、地名、项目名等）作为标签。

## 本次修改的工作过程
1. **数据模型更新**:
   - 在 `DiaryEntry` 接口中添加了 `tags?: string[]` 字段，用于存储自动提取的标签。

2. **创建标签提取 API**:
   - 创建了 `src/app/api/tags/route.ts`，使用 OpenAI GPT-4o-mini 模型提取标签。
   - 提取规则包括：人名、地名、项目名、书名、电影名、组织名等实体。
   - 实现了降级方案：如果没有配置 OpenAI API Key，使用正则表达式进行简单的关键词提取。

3. **自动标签提取流程**:
   - 修改了 `InputArea.tsx` 中的 `handleSend` 方法。
   - 保存日记后，异步调用标签提取 API。
   - 标签提取成功后，自动更新日记条目，添加标签。
   - 标签提取失败不影响日记的正常保存。

4. **UI 显示标签**:
   - 在 `Timeline.tsx` 中，为每条日记显示标签。
   - 标签以蓝色小徽章的形式展示在日记内容下方。
   - 标签样式：圆角、蓝色背景、小字体。

## 技术说明
- **AI 模型**：使用 OpenAI GPT-4o-mini（成本低、速度快）
- **降级方案**：如果没有 API Key，使用正则表达式提取常见实体
- **异步处理**：标签提取不阻塞日记保存，提升用户体验
- **标签限制**：最多提取 10 个标签，每个标签 2-20 个字符

## 使用说明
1. 用户输入日记内容并保存
2. 系统自动调用 AI 提取标签（如："张三"、"北京"、"RAG方案"等）
3. 标签会显示在日记内容下方，方便后续检索和分类

